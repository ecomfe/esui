<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * ESUI (Enterprise Simple UI)
 * Copyright 2013 Baidu Inc. All rights reserved.
 *
 * @ignore
 * @file 链接控件
 * @author miaojian, otakustay
 */
define(
    function (require) {
        var u = require('underscore');
        var lib = require('./lib');
        var Control = require('./Control');
        var paint = require('./painters');

<span id='Link-method-constructor'><span id='Link'>        /**
</span></span>         * 链接控件
         *
         * 很单纯的可以点击的链接，对`&lt;a&gt;`元素的封装
         *
         * 本控件只能使用`&lt;a&gt;`元素作为主元素，如果主元素使用了其它DOM元素，会无法渲染
         *
         * @extends Control
         * @constructor
         */
        function Link() {
            Control.apply(this, arguments);
        }

        Link.prototype = {
            constructor: Link,

<span id='Link-property-type'>            /**
</span>             * 控件类型，始终为`&quot;Link&quot;`
             *
             * @type {string}
             * @readonly
             * @override
             */
            type: 'Link',

<span id='Link-method-getCategory'>            /**
</span>             * 获取控件的分类
             *
             * @return {string} 始终返回`&quot;container&quot;`
             * @override
             */
            getCategory: function () {
                return 'container';
            },

<span id='Link-method-createMain'>            /**
</span>             * 创建控件主元素，始终创建`&lt;a&gt;`元素
             *
             * @return {HTMLElement}
             * @protected
             * @override
             */
            createMain: function () {
                // 主元素只能是a元素
                return document.createElement('a');
            },

<span id='Link-method-initOptions'>            /**
</span>             * 初始化参数
             *
             * 如果初始化配置未给定相关属性，则会从主元素上按以下规则获取：
             *
             * - {@link Link#href}属性使用主元素的`href`属性
             * - {@link Link#target}属性使用主元素的`target`属性
             * - {@link Link#content}属性使用主元素的`innerHTML`
             *
             * @param {Object} [options] 构造函数传入的参数
             * @protected
             * @override
             */
            initOptions: function (options) {
                var properties = {};

                u.extend(properties, options);

                if (options.href == null) {
                    properties.href = this.main.href;
                }

                if (options.target == null) {
                    properties.target = this.main.target;
                }

                //此处暂时放弃使用text，只是用content, 关于text, 控件使用者自己处理
                if (options.content == null) {
                    properties.content = this.main.innerHTML;
                }

                u.extend(this, properties);
            },

<span id='Link-method-initEvents'>            /**
</span>             * 初始化事件交互
             *
             * @protected
             * @override
             */
            initEvents: function () {
<span id='Link-event-click'>                /**
</span>                 * @event click
                 *
                 * 点击时触发，可取消默认行为（链接跳转）
                 *
                 * @preventable
                 */
                this.helper.delegateDOMEvent(this.main, 'click');
            },

<span id='Link-method-render'>            /**
</span>             * 渲染控件
             *
             * @method
             * @protected
             * @override
             */
            render: function () {
                // 如果控件主元素不为`&lt;a&gt;`，则不执行渲染操作
                // 目前处理是让其一直处于`init`状态下
                if (this.main &amp;&amp; this.main.nodeName.toLowerCase() === 'a') {
                    Control.prototype.render.apply(this, arguments);
                }
            },

<span id='Link-property-repaint'>            /**
</span>             * 重渲染
             *
             * @protected
             * @override
             */
            repaint: paint.createRepaint(
                Control.prototype.repaint,
<span id='Link-property-href'>                /**
</span>                 * @property {string} href
                 *
                 * 链接地址
                 */
                paint.attribute('href'),
<span id='Link-property-target'>                /**
</span>                 * @property {string} target
                 *
                 * 链接打开目标，与DOM中对应属性相同
                 */
                paint.attribute('target'),
                {
<span id='Link-property-content'>                    /**
</span>                     * @property {string} content
                     *
                     * 链接内的内容，不进行HTML转义
                     *
                     * 内容支持内部控件，参考{@link Panel#content}属性的说明
                     */
                    name: 'content',
                    paint: function (link, content) {
                        link.helper.disposeChildren();
                        link.main.innerHTML = content;
                        link.helper.initChildren();
                    }
                }
            )

        };

        lib.inherits(Link, Control);
        require('./main').register(Link);
        return Link;
    }
);
</pre>
</body>
</html>
