<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * ESUI (Enterprise Simple UI)
 * Copyright 2013 Baidu Inc. All rights reserved.
 *
 * @ignore
 * @file 文本标签控件
 * @author erik, otakustay
 */
define(
    function (require) {
        var u = require('underscore');
        var lib = require('./lib');
        var Control = require('./Control');

<span id='Label-method-constructor'><span id='Label'>        /**
</span></span>         * 文本标签控件
         *
         * 与{@link Panel}类似，但不允许有内部控件，
         * 设置的内容会被HTML转义，但支持{@link Label#click}事件
         *
         * @extends Control
         * @constructor
         */
        function Label(options) {
            Control.apply(this, arguments);
        }

<span id='Label-property-type'>        /**
</span>         * 控件类型，始终为`&quot;Label&quot;`
         *
         * @type {string}
         * @readonly
         * @override
         */
        Label.prototype.type = 'Label';

<span id='Label-method-createMain'>        /**
</span>         * 创建控件主元素
         *
         * 如果初始化时提供{@link Label#tagName}属性，则以此创建元素，
         * 默认使用`&lt;span&gt;`元素
         *
         * @param {Object} options 构造函数传入的参数
         * @return {HTMLElement}
         * @protected
         * @override
         */
        Label.prototype.createMain = function (options) {
            if (!options.tagName) {
                return Control.prototype.createMain.call(this);
            }
            return document.createElement(options.tagName);
        };

<span id='Label-method-initOptions'>        /**
</span>         * 初始化参数
         *
         * 如果初始化时提供了主元素，则使用主元素的标签名作为{@link Label#tagName}属性
         *
         * 如果未提供{@link Label#text}属性，则使用主元素的文本内容作为此属性的初始值
         *
         * @param {Object} [options] 构造函数传入的参数
         * @override
         * @protected
         */
        Label.prototype.initOptions = function (options) {
            var properties = {};
            u.extend(properties, options);
<span id='Label-property-tagName'>            /**
</span>             * @property {string} tagName
             *
             * 指定主元素标签名
             *
             * 此属性仅在初始化时生效，运行期不能修改
             *
             * @readonly
             */
            properties.tagName = this.main.nodeName.toLowerCase();
            if (options.text == null) {
                properties.text = lib.trim(lib.getText(this.main));
            }
            u.extend(this, properties);
        };

<span id='Label-method-initEvents'>        /**
</span>         * 初始化事件交互
         *
         * @protected
         * @override
         */
        Label.prototype.initEvents = function () {
<span id='Label-event-click'>            /**
</span>             * @event click
             *
             * 点击时触发
             */
            this.helper.delegateDOMEvent(this.main, 'click');
        };

        var paint = require('./painters');

<span id='Label-method-repaint'>        /**
</span>         * 重渲染
         *
         * @method
         * @protected
         * @override
         */
        Label.prototype.repaint = paint.createRepaint(
            Control.prototype.repaint,
<span id='Label-property-title'>            /**
</span>             * @property {string} title
             *
             * 鼠标放置在控件上时的提示信息
             */
            paint.attribute('title'),
<span id='Label-property-text'>            /**
</span>             * @property {string} text
             *
             * 文本内容，会被自动HTML转义
             */
            paint.text('text'),
<span id='Label-property-forTarget'>            /**
</span>             * @property {string} forTarget
             *
             * 与当前标签关联的输入控件的id，仅当主元素为`&lt;label&gt;`元素时生效，相当于`for`属性的效果，但指定的是控件的id
             */
            {
                name: 'forTarget',
                paint: function (label, forTarget) {
                    // 仅对`&lt;label&gt;`元素生效
                    if (label.main.nodeName.toLowerCase() !== 'label') {
                        return;
                    }

                    label.helper.addDOMEvent(
                        label.main,
                        'mousedown',
                        function fixForAttribute() {
                            var targetControl = this.viewContext.get(forTarget);
                            var targetElement = targetControl
                                &amp;&amp; (typeof targetControl.getFocusTarget === 'function')
                                &amp;&amp; targetControl.getFocusTarget();
                            if (targetElement &amp;&amp; targetElement.id) {
                                lib.setAttribute(this.main, 'for', targetElement.id);
                            }

                            this.helper.removeDOMEvent(this.main, 'mousedown', fixForAttribute);
                        }
                    );
                }
            }
        );

<span id='Label-method-setText'>        /**
</span>         * 设置文本
         *
         * @param {string} text 文本内容，参考{@link Label#text}属性的说明
         */
        Label.prototype.setText = function (text) {
            this.setProperties({ text: text });
        };

<span id='Label-method-getText'>        /**
</span>         * 获取文本
         *
         * @return {string}
         */
        Label.prototype.getText = function () {
            return this.text;
        };

<span id='Label-method-setTitle'>        /**
</span>         * 设置标题
         *
         * @param {string} title 需要设置的值，参考{@link Label#title}属性的说明
         */
        Label.prototype.setTitle = function (title) {
            this.setProperties({ title: title });
        };

<span id='Label-method-getTitle'>        /**
</span>         * 获取标题
         *
         * @return {string}
         */
        Label.prototype.getTitle = function () {
            return this.title;
        };

        lib.inherits(Label, Control);
        require('./main').register(Label);
        return Label;
    }
);
</pre>
</body>
</html>
